<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPQI — Algorithmic Trading</title>
<meta name="description" content="IPQI — Systematic algorithmic trading across forex and commodities. AI-assisted research. Rule-based execution. London infrastructure.">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='3' fill='%230a0b0f'/><rect x='3' y='3' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='7' y='3' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='11' y='3' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='15' y='3' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='19' y='3' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='23' y='3' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='27' y='3' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='3' y='7' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='11' y='7' width='3' height='3' rx='0.5' fill='%2322d3ee' opacity='0.85'/><rect x='19' y='7' width='3' height='3' rx='0.5' fill='%2322d3ee' opacity='0.85'/><rect x='27' y='7' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='7' y='11' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='15' y='11' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='23' y='11' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='3' y='15' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='7' y='15' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='11' y='15' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='15' y='15' width='3' height='3' rx='0.5' fill='%23e8eaf0' opacity='1'/><rect x='19' y='15' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='23' y='15' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='27' y='15' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='7' y='19' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='11' y='19' width='3' height='3' rx='0.5' fill='%2322d3ee' opacity='0.85'/><rect x='15' y='19' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='19' y='19' width='3' height='3' rx='0.5' fill='%2322d3ee' opacity='0.85'/><rect x='23' y='19' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='3' y='23' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='15' y='23' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='27' y='23' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='3' y='27' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='7' y='27' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='11' y='27' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='15' y='27' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='19' y='27' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/><rect x='23' y='27' width='3' height='3' rx='0.5' fill='%23fbbf24' opacity='0.85'/><rect x='27' y='27' width='3' height='3' rx='0.5' fill='%23a78bfa' opacity='0.85'/></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #0a0b0f;
    --bg-card: #12131a;
    --bg-card-hover: #181924;
    --border: #1e2030;
    --border-accent: #2a3050;
    --text: #c8cad4;
    --text-dim: #6b7094;
    --text-bright: #e8eaf0;
    --accent: #4a7cff;
    --accent-dim: #2d4a8a;
    --accent-glow: rgba(74, 124, 255, 0.08);
    --green: #34d399;
    --green-dim: rgba(52, 211, 153, 0.1);
    --amber: #f59e0b;
    --cyan: #22d3ee;
    --violet: #a78bfa;
    --mono: 'JetBrains Mono', monospace;
    --sans: 'DM Sans', -apple-system, sans-serif;
  }

  html { scroll-behavior: smooth; }

  body {
    font-family: var(--sans);
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(74, 124, 255, 0.015) 1px, transparent 1px),
      linear-gradient(90deg, rgba(74, 124, 255, 0.015) 1px, transparent 1px);
    background-size: 60px 60px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 860px;
    margin: 0 auto;
    padding: 0 24px;
    position: relative;
    z-index: 1;
  }

  /* ── NAV ── */
  nav { padding: 28px 0; border-bottom: 1px solid var(--border); }
  nav .container { display: flex; justify-content: space-between; align-items: center; }
  .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; }
  .logo-text { font-family: var(--mono); font-size: 18px; font-weight: 400; color: var(--text-bright); letter-spacing: 3px; }
  .logo-text span { color: var(--accent); }
  .nav-links { display: flex; align-items: center; gap: 24px; }
  .nav-links a { font-family: var(--mono); font-size: 11px; color: var(--text-dim); letter-spacing: 1px; text-transform: uppercase; text-decoration: none; transition: color 0.2s; }
  .nav-links a:hover { color: var(--text-bright); }

  /* ── HERO ── */
  .hero { padding: 100px 0 80px; }
  .hero-label {
    font-family: var(--mono); font-size: 11px; color: var(--accent);
    letter-spacing: 2px; text-transform: uppercase; margin-bottom: 20px;
    display: flex; align-items: center; gap: 10px;
  }
  .hero-label::before { content: ''; width: 24px; height: 1px; background: var(--accent); }
  .hero h1 { font-size: clamp(32px, 5vw, 48px); font-weight: 300; color: var(--text-bright); line-height: 1.25; margin-bottom: 24px; letter-spacing: -0.5px; }
  .hero h1 strong { font-weight: 600; }
  .hero p { font-size: 17px; color: var(--text-dim); max-width: 560px; line-height: 1.7; }
  .hero-logo-row { display: flex; align-items: center; gap: 24px; margin-bottom: 28px; }

  /* ── METRICS BAR ── */
  .metrics {
    display: grid; grid-template-columns: repeat(3, 1fr);
    gap: 1px; background: var(--border); border: 1px solid var(--border);
    border-radius: 8px; overflow: hidden; margin: 60px 0;
  }
  .metric { background: var(--bg-card); padding: 28px 20px; text-align: center; }
  .metric-value { font-family: var(--mono); font-size: 22px; font-weight: 400; color: var(--text-bright); margin-bottom: 6px; }
  .metric-label { font-size: 11px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }

  /* ── SECTION ── */
  section { padding: 60px 0; }
  .section-label { font-family: var(--mono); font-size: 11px; color: var(--accent); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 16px; }
  section h2 { font-size: 28px; font-weight: 400; color: var(--text-bright); margin-bottom: 16px; letter-spacing: -0.3px; }
  section h2 strong { font-weight: 600; }
  section > .container > p { color: var(--text-dim); font-size: 15px; max-width: 540px; margin-bottom: 40px; line-height: 1.7; }

  /* ── ABOUT / STORY SECTIONS ── */
  .about-block {
    background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px;
    overflow: hidden; margin-bottom: 24px;
  }
  .about-inner { display: grid; grid-template-columns: 200px 1fr; gap: 0; }
  .about-visual {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 40px 24px; border-right: 1px solid var(--border);
    background: linear-gradient(180deg, #0c0d14 0%, #08090c 100%);
  }
  .about-visual-label { font-family: var(--mono); font-size: 9px; color: var(--text-dim); letter-spacing: 2px; text-transform: uppercase; margin-top: 12px; }
  .about-content { padding: 36px 32px; }
  .about-content h3 { font-size: 18px; font-weight: 500; color: var(--text-bright); margin-bottom: 16px; }
  .about-content p { font-size: 13px; color: var(--text-dim); line-height: 1.85; margin-bottom: 12px; }
  .about-content p:last-child { margin-bottom: 0; }
  .about-content strong { color: var(--text); }
  .about-content .hl { color: var(--accent); }

  .piece-legend {
    display: flex; gap: 14px; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); flex-wrap: wrap;
  }
  .piece-chip { display: flex; align-items: center; gap: 6px; font-size: 10px; color: var(--text-dim); font-family: var(--mono); }
  .piece-chip span { width: 10px; height: 10px; border-radius: 2px; display: inline-block; }

  /* ── CARDS ── */
  .cards { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 32px; }
  .card {
    background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px;
    padding: 28px 24px; transition: border-color 0.3s, background 0.3s;
  }
  .card:hover { border-color: var(--border-accent); background: var(--bg-card-hover); }
  .card-icon {
    font-family: var(--mono); font-size: 13px; color: var(--accent);
    margin-bottom: 14px; display: flex; align-items: center; gap: 8px;
  }
  .card-icon::before { content: ''; width: 6px; height: 6px; background: var(--accent); border-radius: 50%; flex-shrink: 0; }
  .card h3 { font-size: 15px; font-weight: 500; color: var(--text-bright); margin-bottom: 8px; }
  .card p { font-size: 13px; color: var(--text-dim); line-height: 1.65; }

  /* ── ARCHITECTURE FLOW ── */
  .diagram-container {
    margin-top: 40px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 32px 16px 16px;
    position: relative;
    overflow: hidden;
  }
  .diagram-container::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--accent), var(--amber), var(--green));
    opacity: 0.4;
  }
  #archDiagram { width: 100%; height: auto; display: block; }
  .arch-flow { margin-top: 48px; }
  .arch-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px; }
  .arch-block { background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; padding: 24px; position: relative; }
  .arch-block-label { font-family: var(--mono); font-size: 10px; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 12px; display: block; }
  .arch-block-label.blue { color: var(--accent); }
  .arch-block-label.amber { color: var(--amber); }
  .arch-block-label.green { color: var(--green); }
  .arch-block h4 { font-size: 14px; font-weight: 500; color: var(--text-bright); margin-bottom: 6px; }
  .arch-block p { font-size: 12px; color: var(--text-dim); line-height: 1.6; }
  .arch-risk { background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; padding: 24px; position: relative; overflow: hidden; }
  .arch-risk::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: #ef4444; opacity: 0.4; }
  .arch-risk-label { font-family: var(--mono); font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: #ef4444; margin-bottom: 10px; }
  .arch-risk p { font-size: 13px; color: var(--text-dim); line-height: 1.65; }
  .arch-connector { display: flex; justify-content: center; padding: 8px 0; }
  .arch-connector span { font-family: var(--mono); font-size: 14px; color: var(--border-accent); }

  /* ── INFRA SPECS ── */
  .infra-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1px; background: var(--border); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; margin-top: 32px; }
  .infra-item { background: var(--bg-card); padding: 24px; }
  .infra-item h4 { font-family: var(--mono); font-size: 11px; color: var(--accent); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 8px; }
  .infra-item p { font-size: 13px; color: var(--text-dim); line-height: 1.6; }

  /* ── AI SECTION ── */
  .ai-narrative { margin-top: 32px; padding: 32px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; position: relative; overflow: hidden; }
  .ai-narrative::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--accent), var(--green), var(--accent)); opacity: 0.6; }
  .ai-flow { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 24px; margin-top: 24px; }
  .ai-flow-item { text-align: center; position: relative; }
  .ai-flow-icon { font-family: var(--mono); font-size: 28px; margin-bottom: 12px; display: block; }
  .ai-flow-item h4 { font-size: 14px; font-weight: 500; color: var(--text-bright); margin-bottom: 6px; }
  .ai-flow-item p { font-size: 12px; color: var(--text-dim); line-height: 1.55; }
  .ai-flow-arrow { display: none; }
  @media (min-width: 641px) {
    .ai-flow-arrow { display: flex; align-items: center; justify-content: center; font-family: var(--mono); font-size: 18px; color: var(--border-accent); }
    .ai-flow { grid-template-columns: 1fr auto 1fr auto 1fr; }
  }
  .ai-quote { margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--border); font-size: 14px; color: var(--text); font-style: italic; line-height: 1.65; }

  /* ── PRINCIPLES ── */
  .principles { list-style: none; margin-top: 32px; }
  .principles li { padding: 20px 0; border-bottom: 1px solid var(--border); display: grid; grid-template-columns: 32px 1fr; gap: 16px; align-items: start; }
  .principles li:last-child { border-bottom: none; }
  .p-num { font-family: var(--mono); font-size: 12px; color: var(--accent); padding-top: 2px; }
  .principles h4 { font-size: 15px; font-weight: 500; color: var(--text-bright); margin-bottom: 4px; }
  .principles p { font-size: 13px; color: var(--text-dim); line-height: 1.65; }

  /* ── STATUS ── */
  .status-bar { display: inline-flex; align-items: center; gap: 8px; background: var(--green-dim); border: 1px solid rgba(52, 211, 153, 0.15); border-radius: 100px; padding: 8px 16px; margin-top: 40px; }
  .status-dot { width: 7px; height: 7px; background: var(--green); border-radius: 50%; animation: pulse 2s ease-in-out infinite; box-shadow: 0 0 4px var(--green); }
  @keyframes pulse { 0%, 100% { opacity: 1; box-shadow: 0 0 4px var(--green), 0 0 12px var(--green); } 50% { opacity: 0.3; box-shadow: 0 0 2px var(--green); } }
  .status-text { font-family: var(--mono); font-size: 12px; color: var(--green); letter-spacing: 0.5px; }

  /* ── CONTACT ── */
  .contact-section { padding: 80px 0; }
  .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 48px; margin-top: 40px; }
  @media (max-width: 640px) { .contact-grid { grid-template-columns: 1fr; } }
  .contact-info p { font-size: 14px; color: var(--text-dim); line-height: 1.7; margin-bottom: 24px; }
  .contact-form { display: flex; flex-direction: column; gap: 16px; }
  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group label { font-size: 11px; font-family: var(--mono); color: var(--text-dim); letter-spacing: 1px; text-transform: uppercase; }
  .form-group input, .form-group select, .form-group textarea { font-family: var(--sans); font-size: 14px; color: var(--text-bright); background: var(--bg); border: 1px solid var(--border); border-radius: 6px; padding: 12px 14px; outline: none; transition: border-color 0.3s; }
  .form-group input:focus, .form-group select:focus, .form-group textarea:focus { border-color: var(--accent); }
  .form-group select { cursor: pointer; }
  .form-group select option { background: var(--bg-card); }
  .form-group textarea { resize: vertical; min-height: 80px; }
  .submit-btn { font-family: var(--mono); font-size: 13px; letter-spacing: 1px; color: var(--bg); background: var(--accent); border: none; border-radius: 6px; padding: 14px 24px; cursor: pointer; transition: opacity 0.3s; text-transform: uppercase; margin-top: 8px; }
  .submit-btn:hover { opacity: 0.85; }
  .form-success { display: none; text-align: center; padding: 40px 20px; }
  .form-success.show { display: block; }
  .form-success p { font-size: 15px; color: var(--green); margin-bottom: 8px; }
  .form-success span { font-size: 13px; color: var(--text-dim); }

  /* ── FOOTER ── */
  footer { border-top: 1px solid var(--border); padding: 40px 0; }
  footer .container { display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 24px; }
  .footer-company { font-family: var(--mono); font-size: 12px; color: var(--text-dim); margin-bottom: 4px; }
  .footer-reg { font-size: 11px; color: var(--text-dim); opacity: 0.6; }
  .footer-disclaimer { max-width: 420px; font-size: 11px; color: var(--text-dim); opacity: 0.5; line-height: 1.6; }

  /* ── ANIMATIONS ── */
  .fade-in { opacity: 0; transform: translateY(16px); animation: fadeUp 0.6s ease forwards; }
  .fade-in:nth-child(2) { animation-delay: 0.1s; }
  .fade-in:nth-child(3) { animation-delay: 0.2s; }
  .fade-in:nth-child(4) { animation-delay: 0.3s; }
  @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }

  @media (max-width: 640px) {
    .hero { padding: 60px 0 40px; }
    .hero h1 { font-size: 28px; }
    .hero-logo-row { flex-direction: column; align-items: flex-start; gap: 16px; }
    .metrics { grid-template-columns: 1fr 1fr; }
    footer .container { flex-direction: column; }
    .infra-grid { grid-template-columns: 1fr; }
    .cards { grid-template-columns: 1fr; }
    .arch-row { grid-template-columns: 1fr; }
    .about-inner { grid-template-columns: 1fr; }
    .about-visual { border-right: none; border-bottom: 1px solid var(--border); padding: 28px; }
    [style*="grid-template-columns:repeat(3"] { grid-template-columns: 1fr !important; }
  }
</style>
</head>
<body>

<nav>
  <div class="container">
    <a href="/" class="logo">
      <canvas id="navLogo" width="28" height="28"></canvas>
      <span class="logo-text">IPQI<span>.</span></span>
    </a>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="#platform">Platform</a>
      <a href="#about">About</a>
      <a href="#contact">Contact</a>
    </div>
  </div>
</nav>

<header class="hero">
  <div class="container">
    <div class="hero-label fade-in">Systematic. Automated. Disciplined.</div>
    <div class="hero-logo-row fade-in">
      <canvas id="heroLogo" width="72" height="72"></canvas>
      <div>
        <h1><strong>Quantitative trading</strong><br>built to compound</h1>
      </div>
    </div>
    <p class="fade-in">IPQI operates a diversified portfolio of proprietary trading algorithms across FX and commodities. AI-assisted research. Rule-based execution. Fully automated on dedicated infrastructure in London's financial district.</p>
    <div class="status-bar fade-in">
      <div class="status-dot"></div>
      <span class="status-text">Systems operational</span>
    </div>
  </div>
</header>

<div class="container">
  <div class="metrics">
    <div class="metric">
      <div class="metric-value">Multi</div>
      <div class="metric-label">Strategy</div>
    </div>
    <div class="metric">
      <div class="metric-value">24/5</div>
      <div class="metric-label">Runtime</div>
    </div>
    <div class="metric">
      <div class="metric-value">FX &amp; Commodities</div>
      <div class="metric-label">Markets</div>
    </div>
    <div class="metric">
      <div class="metric-value">&lt;3ms</div>
      <div class="metric-label">Execution</div>
    </div>
    <div class="metric">
      <div class="metric-value">London</div>
      <div class="metric-label">Infrastructure</div>
    </div>
    <div class="metric">
      <div class="metric-value">3-Layer</div>
      <div class="metric-label">Protection</div>
    </div>
  </div>
</div>

<section id="platform">
  <div class="container">
    <div class="section-label">How it works</div>
    <h2>The <strong>platform</strong></h2>
    <p>AI researches and builds. Deterministic systems trade. Independent safety layers protect capital around the clock.</p>

    <!-- Architecture Diagram -->
    <div class="diagram-container">
      <svg id="archDiagram" viewBox="0 0 840 520" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <!-- Glow filters -->
          <filter id="glowBlue"><feGaussianBlur stdDeviation="3" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          <filter id="glowAmber"><feGaussianBlur stdDeviation="3" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          <filter id="glowGreen"><feGaussianBlur stdDeviation="3" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          <filter id="glowRed"><feGaussianBlur stdDeviation="2.5" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>

          <!-- Animated dot -->
          <circle id="dotBlue" r="3" fill="#4a7cff" filter="url(#glowBlue)"/>
          <circle id="dotAmber" r="3" fill="#f59e0b" filter="url(#glowAmber)"/>
          <circle id="dotGreen" r="3" fill="#34d399" filter="url(#glowGreen)"/>

          <!-- Arrow marker -->
          <marker id="arrowBlue" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0,2 L10,5 L0,8" fill="none" stroke="#4a7cff" stroke-width="1.5"/></marker>
          <marker id="arrowAmber" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0,2 L10,5 L0,8" fill="none" stroke="#f59e0b" stroke-width="1.5"/></marker>
          <marker id="arrowGreen" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0,2 L10,5 L0,8" fill="none" stroke="#34d399" stroke-width="1.5"/></marker>
          <marker id="arrowDown" viewBox="0 0 10 10" refX="5" refY="10" markerWidth="6" markerHeight="6" orient="auto"><path d="M2,0 L5,10 L8,0" fill="none" stroke="#ef4444" stroke-width="1.2" opacity="0.5"/></marker>
        </defs>

        <!-- ── MARKET DATA INPUT (left) ── -->
        <g class="dia-input" opacity="0.5">
          <text x="24" y="106" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" letter-spacing="1.5" text-anchor="start">MARKET</text>
          <text x="24" y="118" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" letter-spacing="1.5" text-anchor="start">DATA</text>
          <!-- Incoming data lines -->
          <line x1="24" y1="130" x2="24" y2="155" stroke="#2a3050" stroke-width="1" stroke-dasharray="3,4"/>
          <line x1="24" y1="155" x2="68" y2="155" stroke="#2a3050" stroke-width="1" stroke-dasharray="3,4"/>
          <circle r="1.5" fill="#4a7cff" opacity="0.6"><animateMotion dur="2.5s" repeatCount="indefinite" path="M24,130 L24,155 L68,155"/></circle>
        </g>

        <!-- ── NODE 1: RESEARCH ── -->
        <g class="dia-node">
          <rect x="68" y="68" width="200" height="170" rx="8" fill="#12131a" stroke="#1e2030" stroke-width="1"/>
          <!-- Top accent bar -->
          <rect x="68" y="68" width="200" height="2" rx="1" fill="#4a7cff" opacity="0.6"/>
          <!-- Stage label -->
          <text x="88" y="98" font-family="JetBrains Mono, monospace" font-size="9" fill="#4a7cff" letter-spacing="2">01 — RESEARCH</text>
          <!-- Icon area -->
          <circle cx="168" cy="140" r="20" fill="none" stroke="#4a7cff" stroke-width="0.5" opacity="0.3"/>
          <text x="168" y="147" font-size="22" text-anchor="middle" fill="#4a7cff" opacity="0.8">&#x1F52C;</text>
          <!-- Title & desc -->
          <text x="168" y="180" font-family="DM Sans, sans-serif" font-size="14" fill="#e8eaf0" text-anchor="middle" font-weight="500">AI Analysis</text>
          <text x="168" y="198" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">Studies structure. Tests</text>
          <text x="168" y="212" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">hypotheses. Generates logic.</text>
        </g>

        <!-- ── CONNECTOR 1→2 ── -->
        <line x1="268" y1="153" x2="314" y2="153" stroke="#4a7cff" stroke-width="1" opacity="0.35" marker-end="url(#arrowBlue)"/>
        <!-- Animated pulse dot -->
        <circle r="2.5" fill="#4a7cff" filter="url(#glowBlue)">
          <animate attributeName="cx" values="272;308" dur="1.8s" repeatCount="indefinite"/>
          <animate attributeName="cy" values="153;153" dur="1.8s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0;1;1;0" dur="1.8s" repeatCount="indefinite"/>
        </circle>

        <!-- ── NODE 2: CLASSIFY ── -->
        <g class="dia-node">
          <rect x="320" y="68" width="200" height="170" rx="8" fill="#12131a" stroke="#1e2030" stroke-width="1"/>
          <rect x="320" y="68" width="200" height="2" rx="1" fill="#f59e0b" opacity="0.6"/>
          <text x="340" y="98" font-family="JetBrains Mono, monospace" font-size="9" fill="#f59e0b" letter-spacing="2">02 — CLASSIFY</text>
          <circle cx="420" cy="140" r="20" fill="none" stroke="#f59e0b" stroke-width="0.5" opacity="0.3"/>
          <text x="420" y="147" font-size="22" text-anchor="middle" fill="#f59e0b" opacity="0.8">&#x1F4CA;</text>
          <text x="420" y="180" font-family="DM Sans, sans-serif" font-size="14" fill="#e8eaf0" text-anchor="middle" font-weight="500">Market Regime</text>
          <text x="420" y="198" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">Trending, ranging, volatile?</text>
          <text x="420" y="212" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">Adapts strategy in real time.</text>
        </g>

        <!-- ── CONNECTOR 2→3 ── -->
        <line x1="520" y1="153" x2="566" y2="153" stroke="#f59e0b" stroke-width="1" opacity="0.35" marker-end="url(#arrowAmber)"/>
        <circle r="2.5" fill="#f59e0b" filter="url(#glowAmber)">
          <animate attributeName="cx" values="524;560" dur="1.6s" repeatCount="indefinite" begin="0.4s"/>
          <animate attributeName="cy" values="153;153" dur="1.6s" repeatCount="indefinite" begin="0.4s"/>
          <animate attributeName="opacity" values="0;1;1;0" dur="1.6s" repeatCount="indefinite" begin="0.4s"/>
        </circle>

        <!-- ── NODE 3: EXECUTE ── -->
        <g class="dia-node">
          <rect x="572" y="68" width="200" height="170" rx="8" fill="#12131a" stroke="#1e2030" stroke-width="1"/>
          <rect x="572" y="68" width="200" height="2" rx="1" fill="#34d399" opacity="0.6"/>
          <text x="592" y="98" font-family="JetBrains Mono, monospace" font-size="9" fill="#34d399" letter-spacing="2">03 — EXECUTE</text>
          <circle cx="672" cy="140" r="20" fill="none" stroke="#34d399" stroke-width="0.5" opacity="0.3"/>
          <text x="672" y="147" font-size="22" text-anchor="middle" fill="#34d399" opacity="0.8">&#x26A1;</text>
          <text x="672" y="180" font-family="DM Sans, sans-serif" font-size="14" fill="#e8eaf0" text-anchor="middle" font-weight="500">Algo Trading</text>
          <text x="672" y="198" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">Multiple algorithms. Different</text>
          <text x="672" y="212" font-family="DM Sans, sans-serif" font-size="10.5" fill="#6b7094" text-anchor="middle">conditions. Fully automated.</text>
        </g>

        <!-- ── OUTPUT (right) ── -->
        <g class="dia-output" opacity="0.5">
          <line x1="772" y1="153" x2="816" y2="153" stroke="#34d399" stroke-width="1" stroke-dasharray="3,4"/>
          <text x="816" y="148" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" letter-spacing="1.5" text-anchor="end">TRADE</text>
          <text x="816" y="160" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" letter-spacing="1.5" text-anchor="end">OUTPUT</text>
          <circle r="1.5" fill="#34d399" opacity="0.6">
            <animate attributeName="cx" values="775;812" dur="2s" repeatCount="indefinite" begin="0.8s"/>
            <animate attributeName="cy" values="153;153" dur="2s" repeatCount="indefinite" begin="0.8s"/>
            <animate attributeName="opacity" values="0;0.8;0.8;0" dur="2s" repeatCount="indefinite" begin="0.8s"/>
          </circle>
        </g>

        <!-- ── DOWNWARD CONNECTORS TO RISK LAYER ── -->
        <!-- From each node center, down to risk bar -->
        <line x1="168" y1="238" x2="168" y2="290" stroke="#ef4444" stroke-width="0.7" opacity="0.2" stroke-dasharray="4,5" marker-end="url(#arrowDown)"/>
        <line x1="420" y1="238" x2="420" y2="290" stroke="#ef4444" stroke-width="0.7" opacity="0.2" stroke-dasharray="4,5" marker-end="url(#arrowDown)"/>
        <line x1="672" y1="238" x2="672" y2="290" stroke="#ef4444" stroke-width="0.7" opacity="0.2" stroke-dasharray="4,5" marker-end="url(#arrowDown)"/>

        <!-- Monitoring pulse dots going down -->
        <circle r="1.5" fill="#ef4444" opacity="0">
          <animate attributeName="cy" values="240;285" dur="3s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="168;168" dur="3s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0;0.5;0.5;0" dur="3s" repeatCount="indefinite"/>
        </circle>
        <circle r="1.5" fill="#ef4444" opacity="0">
          <animate attributeName="cy" values="240;285" dur="3s" repeatCount="indefinite" begin="1s"/>
          <animate attributeName="cx" values="420;420" dur="3s" repeatCount="indefinite" begin="1s"/>
          <animate attributeName="opacity" values="0;0.5;0.5;0" dur="3s" repeatCount="indefinite" begin="1s"/>
        </circle>
        <circle r="1.5" fill="#ef4444" opacity="0">
          <animate attributeName="cy" values="240;285" dur="3s" repeatCount="indefinite" begin="2s"/>
          <animate attributeName="cx" values="672;672" dur="3s" repeatCount="indefinite" begin="2s"/>
          <animate attributeName="opacity" values="0;0.5;0.5;0" dur="3s" repeatCount="indefinite" begin="2s"/>
        </circle>

        <!-- ── RISK MANAGEMENT LAYER ── -->
        <g class="dia-risk">
          <rect x="68" y="296" width="704" height="110" rx="8" fill="#12131a" stroke="rgba(239,68,68,0.2)" stroke-width="1"/>
          <!-- Red accent top bar -->
          <rect x="68" y="296" width="704" height="2" rx="1" fill="#ef4444" opacity="0.35"/>
          <!-- Shield icon -->
          <text x="100" y="344" font-size="26" fill="#ef4444" opacity="0.7">&#x1F6E1;&#xFE0F;</text>
          <!-- Label -->
          <text x="138" y="322" font-family="JetBrains Mono, monospace" font-size="9" fill="#ef4444" letter-spacing="2" opacity="0.8">AUTONOMOUS RISK MANAGEMENT — ALWAYS ON</text>
          <!-- Description -->
          <text x="138" y="344" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">Three independent safety layers monitor 24/5. Protective action taken</text>
          <text x="138" y="360" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">automatically if any threshold is breached. Capital protection first.</text>

          <!-- Safety layer chips -->
          <!-- Chip 1 -->
          <rect x="138" y="374" width="120" height="22" rx="4" fill="rgba(239,68,68,0.06)" stroke="rgba(239,68,68,0.15)" stroke-width="0.5"/>
          <text x="198" y="389" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" text-anchor="middle" letter-spacing="0.5">EA Circuit Breakers</text>
          <!-- Chip 2 -->
          <rect x="268" y="374" width="110" height="22" rx="4" fill="rgba(239,68,68,0.06)" stroke="rgba(239,68,68,0.15)" stroke-width="0.5"/>
          <text x="323" y="389" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" text-anchor="middle" letter-spacing="0.5">Equity Watchdog</text>
          <!-- Chip 3 -->
          <rect x="388" y="374" width="100" height="22" rx="4" fill="rgba(239,68,68,0.06)" stroke="rgba(239,68,68,0.15)" stroke-width="0.5"/>
          <text x="438" y="389" font-family="JetBrains Mono, monospace" font-size="8" fill="#6b7094" text-anchor="middle" letter-spacing="0.5">Human Review</text>

          <!-- Scanning line animation across risk layer -->
          <line x1="68" y1="298" x2="68" y2="298" stroke="#ef4444" stroke-width="1" opacity="0.15">
            <animate attributeName="x1" values="68;772" dur="4s" repeatCount="indefinite"/>
            <animate attributeName="x2" values="108;812" dur="4s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0;0.2;0.2;0" dur="4s" repeatCount="indefinite"/>
          </line>
        </g>

        <!-- ── DETAIL ROW ── -->
        <!-- Divider -->
        <line x1="68" y1="432" x2="772" y2="432" stroke="#1e2030" stroke-width="0.5"/>

        <!-- Col 1 -->
        <text x="68" y="458" font-family="JetBrains Mono, monospace" font-size="9" fill="#4a7cff" letter-spacing="1">AI BUILDS, RULES TRADE</text>
        <text x="68" y="476" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">AI generates and validates strategies.</text>
        <text x="68" y="492" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">Every live trade follows deterministic</text>
        <text x="68" y="508" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">rules — no black boxes, fully auditable.</text>

        <!-- Col 2 -->
        <text x="320" y="458" font-family="JetBrains Mono, monospace" font-size="9" fill="#f59e0b" letter-spacing="1">RIGHT TOOL, RIGHT MARKET</text>
        <text x="320" y="476" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">Trend-following in trends. Mean-</text>
        <text x="320" y="492" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">reversion in ranges. The system reads</text>
        <text x="320" y="508" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">conditions and adapts continuously.</text>

        <!-- Col 3 -->
        <text x="572" y="458" font-family="JetBrains Mono, monospace" font-size="9" fill="#34d399" letter-spacing="1">DIVERSIFIED BY DESIGN</text>
        <text x="572" y="476" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">Different strategies, sessions, and</text>
        <text x="572" y="492" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">instruments. When one approach is</text>
        <text x="572" y="508" font-family="DM Sans, sans-serif" font-size="11" fill="#6b7094">quiet, another is working.</text>
      </svg>
    </div>

  </div>
</section>

<section>
  <div class="container">
    <div class="section-label">Infrastructure</div>
    <h2>Built for <strong>reliability</strong></h2>
    <p>Purpose-built trading infrastructure designed for speed, uptime, and autonomous operation.</p>
    <div class="cards">
      <div class="card">
        <div class="card-icon">01</div>
        <h3>Diversified Portfolio</h3>
        <p>Multiple independent algorithms operating across different strategies, market conditions, and trading sessions — designed to perform in varying environments.</p>
      </div>
      <div class="card">
        <div class="card-icon">02</div>
        <h3>Adaptive Awareness</h3>
        <p>The platform continuously monitors market conditions and adjusts strategy selection in real time. The right approach for the right environment, automatically.</p>
      </div>
      <div class="card">
        <div class="card-icon">03</div>
        <h3>Layered Risk Control</h3>
        <p>Multiple independent safety mechanisms operate simultaneously. If any single layer fails, others continue to protect capital autonomously.</p>
      </div>
      <div class="card">
        <div class="card-icon">04</div>
        <h3>Verified Performance</h3>
        <p>All results tracked and independently verified through third-party platforms. No black boxes. Statistical simulation validates forward-looking probability.</p>
      </div>
    </div>
    <div class="infra-grid" style="margin-top:32px;">
      <div class="infra-item">
        <h4>Location</h4>
        <p>Dedicated server infrastructure in London's financial district. Low-latency connectivity to major liquidity venues. Always on, always monitored.</p>
      </div>
      <div class="infra-item">
        <h4>Execution</h4>
        <p>ECN execution through an FCA-regulated broker. Raw spreads, institutional-grade fills, no dealing desk intervention.</p>
      </div>
      <div class="infra-item">
        <h4>Markets</h4>
        <p>Focused on the world's most liquid FX and commodities markets. Deep liquidity, tight spreads, round-the-clock coverage.</p>
      </div>
    </div>
  </div>
</section>

<section>
  <div class="container">
    <div class="section-label">Philosophy</div>
    <h2>Operating <strong>principles</strong></h2>
    <ul class="principles">
      <li>
        <span class="p-num">01</span>
        <div>
          <h4>Automation over intuition</h4>
          <p>Every trade is backed by thousands of data points across multiple timeframes, market conditions, and risk variables — analysis at a depth and speed no human could replicate. We trade on research and evidence, never emotion.</p>
        </div>
      </li>
      <li>
        <span class="p-num">02</span>
        <div>
          <h4>Capital preservation first</h4>
          <p>Risk management is the primary function. Multiple independent safety layers all prioritise protecting capital over capturing returns.</p>
        </div>
      </li>
      <li>
        <span class="p-num">03</span>
        <div>
          <h4>Evidence-based decisions</h4>
          <p>No strategy runs live without statistical validation. Rigorous testing, simulation, and minimum sample sizes gate every deployment decision.</p>
        </div>
      </li>
      <li>
        <span class="p-num">04</span>
        <div>
          <h4>Simple beats complex</h4>
          <p>Robust systems use proven techniques. No overfit parameters, no complexity for its own sake. Transparent logic that can be audited and explained.</p>
        </div>
      </li>
    </ul>
  </div>
</section>

<!-- ══ ABOUT ══ -->
<section id="about">
  <div class="container">
    <div class="section-label">About</div>
    <h2>Every possible move. <strong>One position.</strong></h2>

    <div class="about-block">
      <div class="about-inner">
        <div class="about-visual">
          <canvas id="aboutLogo" width="140" height="140"></canvas>
          <div class="about-visual-label">Piece DNA from d4</div>
        </div>
        <div class="about-content">
          <h3>Strategy runs deep</h3>
          <p>Before algorithms, there was chess. Competing at national level as a child taught me a discipline that no textbook could: <strong>study the full board, understand what every piece is capable of, think several moves ahead and commit.</strong></p>
          <p>That's how we approach markets. Not one indicator, not one timeframe — the full position. Multiple strategies scanning simultaneously, each with its own pattern, each waiting for its moment to arise.</p>
          <p>Our logo carries this forward. The 8×8 grid encodes every chess piece's movement pattern from a single square — <span class="hl">knight</span>, <span class="hl">bishop</span>, <span class="hl">rook</span>, <span class="hl">queen</span> — overlaid into one image. The complete vocabulary of chess intelligence, compressed into 64 cells.</p>
          <div class="piece-legend">
            <div class="piece-chip"><span style="background:var(--cyan)"></span>Knight</div>
            <div class="piece-chip"><span style="background:var(--violet)"></span>Bishop</div>
            <div class="piece-chip"><span style="background:var(--amber)"></span>Rook</div>
            <div class="piece-chip"><span style="background:var(--accent)"></span>Queen</div>
            <div class="piece-chip"><span style="background:var(--text-bright)"></span>Origin</div>
          </div>
        </div>
      </div>
    </div>

    <div class="about-block">
      <div class="about-content" style="padding:32px;">
        <h3>Trusted relationships, real results</h3>
        <p>At Sun Microsystems, I was responsible for one of the largest trading technology relationships in the world: Reuters. Rather than pitch products, we proposed something different — a global survey across Reuters' entire trader base, branded as their own initiative. No sales agenda. Just one question: what do you actually need?</p>
        <p>The answer was clear: Single Sign-On across their fragmented product suite. We built it with them. They deployed it globally.</p>
        <p>The lesson that shaped everything since: the best relationships are built on trust. Start by asking the right question, not selling the right answer.</p>
      </div>
    </div>

  </div>
</section>

<section class="contact-section" id="contact">
  <div class="container">
    <div class="section-label">Contact</div>
    <h2>Get in <strong>touch</strong></h2>
    <div class="contact-grid">
      <div class="contact-info">
        <p>IPQI is currently in its validation phase, trading proprietary capital. We are not currently accepting external investment.</p>
        <p>If you're interested in learning more about our approach, exploring future opportunities, or discussing algorithmic trading, we'd be happy to hear from you.</p>
        <p style="font-size:14px;color:var(--text-dim);margin-top:8px;">Fill in the form and we'll get back to you.</p>
      </div>
      <div>
        <form class="contact-form" id="contactForm" action="https://formspree.io/f/mqedenny" method="POST">
          <div class="form-group">
            <label>Name</label>
            <input type="text" name="name" required placeholder="Your name">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" required placeholder="you@example.com">
          </div>
          <div class="form-group">
            <label>Interest</label>
            <select name="interest" required>
              <option value="" disabled selected>Select one</option>
              <option value="updates">Receive updates</option>
              <option value="partnerships">Strategic partnerships</option>
              <option value="collaboration">Collaboration</option>
              <option value="learn">Learn more about our approach</option>
            </select>
          </div>
          <div class="form-group">
            <label>Message (optional)</label>
            <textarea name="message" placeholder="Anything you'd like us to know"></textarea>
          </div>
          <button type="submit" class="submit-btn">Send</button>
        </form>
        <div class="form-success" id="formSuccess">
          <p>Message received.</p>
          <span>We'll be in touch shortly.</span>
        </div>
      </div>
    </div>
  </div>
</section>

<footer>
  <div class="container">
    <div class="footer-left">
      <div class="footer-company">IPQI</div>
      <div class="footer-reg">London, United Kingdom</div>
    </div>
    <div class="footer-disclaimer">
      IPQI Ltd trades proprietary capital only and does not provide financial advice, manage external funds, or offer investment services. Past performance is not indicative of future results. Trading derivatives carries significant risk of loss.
    </div>
  </div>
</footer>

<script>
  // ═══════════════════════════════════════════════════════
  // IPQI PIECE DNA — CHESS MOVEMENT PATTERNS
  // ═══════════════════════════════════════════════════════

  const N = 8;
  const ORIGIN = [4, 3]; // d4

  const COL = {
    knight: '#22d3ee', bishop: '#a78bfa', rook: '#fbbf24',
    queen: '#4a7cff', origin: '#e8eaf0'
  };

  function inBounds(r, c) { return r >= 0 && r < N && c >= 0 && c < N; }

  function knightMoves() {
    const [or, oc] = ORIGIN;
    return [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]]
      .map(([dr,dc]) => [or+dr, oc+dc]).filter(([r,c]) => inBounds(r,c));
  }
  function slideMoves(dirs) {
    const [or, oc] = ORIGIN; const m = [];
    for (const [dr,dc] of dirs) for (let i=1;i<N;i++) {
      const r=or+dr*i, c=oc+dc*i; if(inBounds(r,c)) m.push([r,c]); else break;
    } return m;
  }
  const bishopMoves = () => slideMoves([[-1,-1],[-1,1],[1,-1],[1,1]]);
  const rookMoves = () => slideMoves([[-1,0],[1,0],[0,-1],[0,1]]);
  const queenMoves = () => [...bishopMoves(), ...rookMoves()];

  const PIECES = { knight: knightMoves(), bishop: bishopMoves(), rook: rookMoves(), queen: queenMoves() };

  function cellPiece(r, c) {
    if (r === ORIGIN[0] && c === ORIGIN[1]) return 'origin';
    if (PIECES.knight.some(([pr,pc]) => pr===r && pc===c)) return 'knight';
    const isB = PIECES.bishop.some(([pr,pc]) => pr===r && pc===c);
    const isR = PIECES.rook.some(([pr,pc]) => pr===r && pc===c);
    if (isB && isR) return 'queen';
    if (isB) return 'bishop';
    if (isR) return 'rook';
    return null;
  }

  const CELL_PIECE = Array.from({length:N}, (_,r) => Array.from({length:N}, (_,c) => cellPiece(r,c)));
  const _s = ((s) => () => { s=(s*16807)%2147483647; return s/2147483647; })(42);
  const NOISE = Array.from({length:N}, () => Array.from({length:N}, () => 0.06+_s()*0.14));
  const dimCol = '#2a2b35';

  function draw(ctx, size, cellOp, cellCol) {
    const pad=size*0.04, space=size-pad*2, gap=space*0.035, cell=(space-gap*(N-1))/N, rad=Math.max(0.5,cell*0.1);
    ctx.clearRect(0,0,size,size);
    for (let r=0;r<N;r++) for (let c=0;c<N;c++) {
      ctx.globalAlpha = cellOp[r][c];
      ctx.fillStyle = cellCol[r][c];
      ctx.beginPath(); ctx.roundRect(pad+c*(cell+gap), pad+r*(cell+gap), cell, cell, rad); ctx.fill();
    }
    ctx.globalAlpha = 1;
  }

  function hexToRgb(h) { return [parseInt(h.slice(1,3),16), parseInt(h.slice(3,5),16), parseInt(h.slice(5,7),16)]; }
  function rgbToHex(r,g,b) { return '#'+[r,g,b].map(v=>Math.round(Math.max(0,Math.min(255,v))).toString(16).padStart(2,'0')).join(''); }
  function lerpCol(a,b,t) { const [ar,ag,ab]=hexToRgb(a),[br,bg,bb]=hexToRgb(b); return rgbToHex(ar+(br-ar)*t,ag+(bg-ag)*t,ab+(bb-ab)*t); }

  function startSearch(canvas) {
    const ctx=canvas.getContext('2d'), size=canvas.width;
    const curOp=Array.from({length:N},(_,r)=>Array.from({length:N},(_,c)=>NOISE[r][c]));
    const tgtOp=Array.from({length:N},(_,r)=>Array.from({length:N},(_,c)=>NOISE[r][c]));
    const curCol=Array.from({length:N},()=>Array.from({length:N},()=>dimCol));
    const tgtCol=Array.from({length:N},()=>Array.from({length:N},()=>dimCol));

    const seq=['knight','bishop','rook','queen','all'];
    let seqIdx=0, phase='searching', phaseStart=0, lastPulse=0, nextPulse=150;
    const SMIN=3000,SMAX=5500,REVEAL=250,HOLD=600,DISSOLVE=800;
    let nextDisc=SMIN+Math.random()*(SMAX-SMIN);

    function setNoise(){for(let r=0;r<N;r++)for(let c=0;c<N;c++){tgtOp[r][c]=NOISE[r][c];tgtCol[r][c]=dimCol;}}
    function setDisc(){
      const type=seq[seqIdx%seq.length];
      for(let r=0;r<N;r++)for(let c=0;c<N;c++){
        if(r===ORIGIN[0]&&c===ORIGIN[1]){tgtOp[r][c]=1;tgtCol[r][c]=COL.origin;continue;}
        if(type==='all'){const p=CELL_PIECE[r][c];if(p&&p!=='origin'){tgtOp[r][c]=0.9;tgtCol[r][c]=COL[p];}else{tgtOp[r][c]=0.015;tgtCol[r][c]=dimCol;}}
        else{const moves=PIECES[type]||[];if(moves.some(([pr,pc])=>pr===r&&pc===c)){tgtOp[r][c]=0.95;tgtCol[r][c]=COL[type];}else{tgtOp[r][c]=0.015;tgtCol[r][c]=dimCol;}}
      }
    }

    function frame(t){
      if(!phaseStart)phaseStart=t; const el=t-phaseStart;
      if(phase==='searching'&&el>nextDisc){phase='revealing';phaseStart=t;setDisc();}
      else if(phase==='revealing'&&el>REVEAL){phase='holding';phaseStart=t;}
      else if(phase==='holding'&&el>HOLD){phase='dissolving';phaseStart=t;setNoise();}
      else if(phase==='dissolving'&&el>DISSOLVE){phase='searching';phaseStart=t;seqIdx++;nextDisc=SMIN+Math.random()*(SMAX-SMIN);}

      if(phase==='searching'&&t-lastPulse>nextPulse){
        lastPulse=t;nextPulse=100+Math.random()*250;
        for(let i=0;i<2+Math.floor(Math.random()*4);i++){
          const r=Math.floor(Math.random()*N),c=Math.floor(Math.random()*N);
          tgtOp[r][c]=0.25+Math.random()*0.35;
          if(Math.random()>0.7){const p=CELL_PIECE[r][c];if(p&&p!=='origin')tgtCol[r][c]=COL[p];}
          setTimeout(()=>{tgtOp[r][c]=NOISE[r][c];tgtCol[r][c]=dimCol;},80+Math.random()*150);
        }
      }

      const os=phase==='revealing'?0.22:phase==='dissolving'?0.04:0.14;
      const cs=phase==='revealing'?0.18:phase==='dissolving'?0.03:0.10;
      for(let r=0;r<N;r++)for(let c=0;c<N;c++){curOp[r][c]+=(tgtOp[r][c]-curOp[r][c])*os;curCol[r][c]=lerpCol(curCol[r][c],tgtCol[r][c],cs);}
      draw(ctx,size,curOp,curCol); requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  }

  // Static "all pieces" for small canvases
  function drawStatic(canvas) {
    const ctx=canvas.getContext('2d'), size=canvas.width;
    const op=Array.from({length:N},()=>Array.from({length:N},()=>0));
    const col=Array.from({length:N},()=>Array.from({length:N},()=>dimCol));
    for(let r=0;r<N;r++)for(let c=0;c<N;c++){
      const p=CELL_PIECE[r][c];
      if(p==='origin'){op[r][c]=1;col[r][c]=COL.origin;}
      else if(p){op[r][c]=0.85;col[r][c]=COL[p];}
      else{op[r][c]=0.04;col[r][c]=dimCol;}
    }
    draw(ctx,size,op,col);
  }

  // Init logos — nav is static, hero and about are animated
  drawStatic(document.getElementById('navLogo'));
  startSearch(document.getElementById('heroLogo'));
  startSearch(document.getElementById('aboutLogo'));

  // Contact form
  const form = document.getElementById('contactForm');
  const success = document.getElementById('formSuccess');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    try {
      const res = await fetch(form.action, { method:'POST', body:new FormData(form), headers:{'Accept':'application/json'} });
      if (res.ok) { form.style.display='none'; success.classList.add('show'); }
    } catch(err) { form.submit(); }
  });
</script>

</body>
</html>
